●車載向けECUは大きく５系統
大衆車で70～100、高級車では100を超える電子プラットホームECUを搭載。

1.パワトレ系（パワー・トレイン）
2.シャシ系
3.ボディ系
4.マルチメディア系
5.ADAS系

＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
◆1.パワトレ系（パワー・トレイン）
＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

●ペダル操作を速度に置き換える

車の3大機能として，「走る」，「止まる」，「曲がる」のうち，
走る機能の制御に重きを置いたものがパワー・トレイン（通称：パワトレ）系のECUです．

役割はずばり，車輪を駆動するエンジンやモータを，運転手のアクセル・ペダル操作に従って希望するトルク（≒速度）に置き換えることです．
ここで「トルクを制御する」と書いたパワトレ系ECU ですが，現代の車はアクセルの移動量を単に回転数や速度として与えるだけではありません．
路面状況，加速度，ステアリング角度，加速/減速状態などセンサ情報とアクセル開度をもとに，エンジンECUやモータ制御ECUが適切な処理をします．
この制御理論をトルク・ドメイン制御（Torque Domain Control）と呼び，
ハイブリッド車の登場によってエンジンという内燃機関に対してモータを付加したことで，

・エンジンECU
・モータ制御ECU
・エンジン＆モータから適切なトルクを取り出すHV 制御ECU
・オルタネータ（発電機）制御ECU

がパワトレ系ECU として存在するようになりました．

●オルタネータもECUで制御される

発電機としてのオルタネータは従来からありましたが，
最新のオルタネータは常時発電をするものではなく，
必要な発電量を外部から与えられて車両内の各部に電力を供給したり，
時には発電を停止したりするなど，ECUによって制御されています．
またEV（ElectricVehicle）では，オルタネータそのものが搭載されておらず，
駆動系モータを利用して発電を行う場合が主であるため，ここではパワトレ系ECUとして分類しています．

● ネットワーク…CAN やLIN が主流

パワトレ系ECUは，車の中でも大変重要な制御対象です．
万が一にもバッテリやエンジン，発電機などの機器にトラブルが起きた場合，大問題になります．
ですから，これらのECUで使われるハードウェアやソフトウェアには，複数の安全機構を取り入れています．
同様に，ECUを制御するための車載ネットワークには高い信頼性が求められます．
主にCAN（ControllerArea Network）が用いられますが，低速でもよい用途ではLIN（Local Interconnect Network）も使用されます．

▶ EV カーのパワトレ系ECUは主に4 つ
EVカーのパワトレ系ECUは，以下の4つの部位で使われています（図2）．

1）大容量バッテリ
2） バッテリ電力をモータに伝えるための充放電制御インバータ
3） 車軸駆動用モータ＋トランスミッション（変速機構）
4）外部急速充電やAC 充電に対応するインバータ

これらの主要機能以外にも，モータやインバータ，バッテリの温度管理をする各種温度センサや電圧/電流センサなどを使って，
さまざまな電力状況を監視する必要がありますし，
補機（ラジエータやオイル・クーラ）類の冷却系システムなども制御対象になります．

▶ EV カーでは走行中の電力状況把握が重要となる

EVカーの走行中，坂道と平坦な土地ではアクセルの踏み込みが異なることでモータの出力トルクが変わります．
平坦時に比べて上り坂であれば，モータのトルクを増加させるためにアクセルが踏み込まれることで供給電流は増えますし，
下り坂では逆にアクセルが緩められることで供給電流を減らすか，回生と言うモータの逆起電力をバッテリに返す動作を行います．
なお，回生はインバータに複雑な制御が必要なため，回生機能をサポートしていないEV もあります．

一般的な走行シーンで，パワトレ系ECUでは，モータの駆動状況のモニタリングは重要な役割を担い，
出力負荷となるモータの電圧や電流はモータ制御用ECUだけでなく，
バッテリ制御用ECUとも共有し，「出せる電力量」と「出したい電力量」を考慮してバッテリに優しい乗り心地に適した制御をするというわけです．

▶ECU 間通信にはCANバスが使われる

このため，各種ECUを協調制御するために，パワトレ系ECUというドメインの中であっても，ネットワークを組む必要があります．
このネットワークでは主にCANが使用されます（図3）．
CANの規格では125k 〜1Mbpsで使用可能です．
そして，パワトレ系ECU間通信で用いられるものはhigh-speed CANまたはCAN-Cと呼ばれる高速なバス規格が用いられており，
通常は500k 〜1Mbpsが使用されています．

▶ ECU に接続するセンサにはLIN バスが使われる

各ECUに接続されるセンサも，センサ情報をGPIOなどで取得するわけではなく，ネットワークで接続されます．
これらのセンサ・モジュールの多くが，車載用のマイコンで制御されていますが，1msや10ms単位での取得で十分なために，
不必要に高速なCANバスのコントローラを使うよりも，マイコンに内蔵された8ビット・シリアル・インターフェースの応用で使用可能なLINがコスト的に有利です．
従って電圧/電流センサや温度センサなどの入力にはLINが使われています．
また，バッテリやインバータ，モータは走行中に熱を帯びますが，これらの熱を冷却する必要があります．
そのため冷却触媒の循環ポンプや冷却ファンを駆動するために，これらの接続されたマイコンやECUに対して冷却モータの駆動指示を，
LINネットワークを介して行います．
CANもLINもパワトレ系ECUでは，過去からの採用実績が豊富であり，開発から評価までの方式も確立しているために，
とても信頼性の高いネットワークであると言えます．
また，LINの20kbpsからhigh-speedCANの500kbps 〜1Mbpsまでの範囲で，十分にパワトレ系ECUの制御が行えるという点も，
これら2種類の車載ネットワークが選ばれている理由になります．

＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊
コラム EVやHVでは熱のコントロールが重要になる
＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊

● モータは冷やして使うのが良い
モータは冷却すればするほど効率が上がります．
モータが冷え冷えで今日は効率が良い! というのは，なにもアニメ内だけではありません（AKIRA@1988）．
走行中，バッテリやインバータ，モータは発熱するために，冷却する必要があります．
冷却方式には空冷式と液冷式の2つがあり，空冷式に比べて液冷式の方が，放熱特性が優れています．

一般的には液冷式の放熱では，モータやバッテリ，インバータの発熱部位に内部が中空となったパイプで張り巡らされた放熱機能が組み込んであります．
例えばインバータでは，MOSFETやIGBT（絶縁ゲート型バイポーラ・トランジスタ）の放熱板に冷却パイプが配されています．
そしてこの冷却パイプにクーラントと呼ばれる液体の冷媒を流して循環させることで熱の移動が行われ，
放熱用の冷却ファンが実装されたラジエータと呼ばれる放熱装置で冷却します．

この一連の放熱には，モータやインバータ，バッテリの各部に設置された温度センサからの情報をもとに，
ECUからの指示で冷媒を循環させるポンプを駆動したり，ラジエータに取り付けられた冷却ファンを回転させたりします．
これにより，モータなどの発熱部位からの排熱を効率良く冷却します．

● ハイブリッド・カーでは蓄熱も重要

ちなみに本稿の解説では，EVの冷却のみに主眼を置いておりますが，
日本の自動車メーカの得意分野でもあるモータとエンジンの複合ユニットを持つハイブリッド・カー（HV）では，蓄熱も重要な役目です．

寒冷地におけるエンジン始動やアイドリング・ストップ時に，あまりに低温状態では過冷却となってしまい，燃費に影響を与えます．
そこで走行時の排熱を温水タンクに溜めてエンジンの再始動時に利用しています．
当然，寒冷地での使用を想定したEVカーでは，搭載バッテリの種類によってはヒータ機能を搭載する車種もあります．
そうなると，温度管理を行う必要があります．
このように熱管理（サーマル・マネジメント）は，重要な機能の1つになります．


＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
◆２．シャシ系ECU
＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

● ブレーキやサスペンションを制御する

車の3大機能の1つ「走る」を，車の心臓に当たる部分のエンジンまたはモータが担当します．
「止まる」と「曲がる」の機能を実現するのがブレーキやミッション，サスペンションであり，車の走行性，快適性，安全性を性格付けます．
これらの機能制御を行うECU を，シャシ系ECU と呼称します．

● 機能安全系の品質確保を厳しく求められる

前項のパワトレ系ECUと，ここで紹介するシャシ系ECUは，車を構築する根幹技術です．
特筆すべきはシャシ系ECUの制御対象（図4）は機構部品であるため，パワトレ系ECUと同様に過酷な使用環境に耐える必要があることです．
また，シャシ系ECUは，燃料供給や電源喪失になったら停止するパワトレ系ECUとは異なり，
電源喪失時や故障時もブレーキ制御など一部の機能は複数パスで確実な動作を保障しなければなりません．
シャシ系ECUは，ハードウェアもソフトウェアもISO 26262，AutomotiveSPICEなどやOEMメーカ策定の機能安全系品質の確保が厳しく求められている点も特徴です．
そのためシャシ系ECUのサプライヤは，同時に機構部品の製造メーカである場合がほとんどであり，
電気/電子の知識だけでなく，機構部品の物理的な挙動の理解も必要です．

● とにかく低遅延で確実な動作が求められる

シャシ系のECUは，パワトレ系のECUと同じように，信頼性が高く，とにかく壊れない，そして異常な挙動を起こさないように作られています．
また，シャシ系ECUは，電気自動車や燃料電池車というようなパワトレ系がエンジンから電気系に変化したものと比べて，
あくまで制御対象は油圧アクチュエータ（ブレーキ）やギア（ステアリング）などの機械が対象になります．
昨今では，全車装備であるエアー・バッグ・システムもシャシ系の1つです．
衝突を検出するための加速度センサによってハンドル内や助手席前面，

またはサイド・ドア内に組み込まれているエアー・バッグを瞬時に膨らませて乗客の安全を守る機能やトラクション・コントロール（タイヤの空転防止），
急制動時の車体振動を防ぐためのブレーキと連動した車体挙動の自動制御なども，シャシ系ECU が行います．

メカトロニクスとエレクトロニクスの両面での制御となるので，応答性能や反応速度は電子回路とは異なる水準で要求されます．
確実に一定時間以内に応答するように，さまざまな仕組みで作られています．

● ネットワーク…主にCAN が使われている

• ブレーキ・アシスト
• アンチロック・ブレーキ（ABS）
• 排気（エアー）ブレーキ
• 衝突緩衝エアー・バッグ
• 横滑り検出/車両姿勢推定+安定化制御
• アクティブ・サスペンション
• トランスミッション
• パワー・ステアリング
• クルーズ・コントロール
• バッテリ/オルタネータ補機系

シャシ系ECUには主にCANが使われています．
ちなみにシャシ系ECUには加速度センサや油圧/空気圧アクチュエータ，パワー・ステアリングなどが接続されていますが，
これらはマイコンのディジタルI/OやアナログI/Oで接続されており，車内ネットワークに接続されていません（図5）．
なぜなら，衝突検出や緊急ブレーキ・アシストなどは，1000分の1秒を争う時間内での制御が必須となるため，
車内のネットワークにつなげることで遅れが生じてはいけないからです．
また，1 つのセンサ情報を複数のECUで共有する必要もないですし，
1つのアクチュエータやモータ類を複数のECUから排他処理などで制御することもありません．
このように，車載ネットワークが進化する中で，応答時間（＝レイテンシ）の保証が必要なものについては，
車載ネットワークとは接続せずに直接，ECU から制御しています．

図5中のエアー・バッグECUの場合，衝突時の高Gを検出する加速度センサの入力をマイコンが常時監視し，
衝突状態を検出すると直ちにエアー・バッグに点火指示を出します．
これらの操作はマイコンの汎用I/Oです．

そして，高Gの衝突検出を行った結果，
運転している車にE-コールと呼ばれる警察や病院などの緊急通報システムが搭載されている車種であれば，
CANを通じてエアー・バッグECUが衝突検出をしたという情報が非常時通信用ECU注1に送られ，
このECUが外部通報機関に自車のGPS座標や車種名などの情報を通知します．

● 今後はCAN FD に置き換えられる

CANバスの通信速度は最大1Mbpsであり，通常は500kbpsか1Mbpsで運用されます．
これよりも高速な規格としてCAN FDがあります．
駆動用モータやインバータなどのパワトレ系ECUでは，電気自動車が市場の目玉になり，徐々にCAN FDを採用しています．
シャシ系ECUもCAN FDへと切り替えが進むと思われます．これには2つの理由があります．

▶理由1…パワトレ系ECUとADAS系ECUが協調するから

1つ目はADAS系ECUとパワトレ系およびシャシ系ECUの協調制御です．
ADAS（先進運転アシスト機能）で採用されている前方カメラを用いた追突防止や自動ブレーキ・アシストは，
AEBS（Advanced Emergency Break System）という名称で，法令によって今後発売される新車には装着が義務付けられます
（2021年11 月から．ただし義務化前から発売されている車種を含めた全新車装備は2025年以降）．
また，AEBSブレーキ・アシストの先には，いずれ自動運転の要素が入って自動障害物回避も求められるでしょう．
このため，ADAS系ECUからの信号をシャシ系ECUのステアリングやブレーキ/アクセル・ペダルと連携する必要があるのですが，
現在のCANでは，バス上のデバイスが多く，送受信を行う伝送速度的にも大量かつ突発的なデータを流すには非力なのです．

▶理由2…ファームウェアの更新を無線経由で行うから

2つ目はこれらADAS系ECUとの協調制御に対応するためのファームウェアのアップデートに，現在のCANではあまりに遅いからです．
デバッグ時も当然ですが，近い将来にADAS動作を前提としてシャシ系ECUもファームウェアのアップデートを
前記のE-コールを筆頭とする通信用ECUの要求に応じて行う必要があります．
この通信用ECU 経由でファームウェアをアップデートすることをOTAやFOTA（注2）と呼びますが，
昨今のシャシ系ECUでは数M 〜数十MバイトのフラッシュROMを内包したものもあります．
従って，可能な限り高速かつ信頼性の高い車載ネットワークを介して，シャシ系ECUのアップデートが行われる必要があります．
ですから，今後の流れとしてはCANからCAN FDへの進化や，規格化が進むCAN XLなどの次世代の高速なCANを採用することが現実的ではないかと思います．

＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
◆３．ボディ系ECU
＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

● 車に快適さをプラスする

ボディ系ECUは遠隔コントロール，メータ・コンソール，パワー・ウィンドウ，エアコン，サイド/リア・ドア，室内灯などの快適さを向上させるために搭載されます．
ボディ系ECUは，走る/曲がる/止まるといった基本動作に対して，「快適さ」を与える大切なコントローラです．
1つ1つの機能は比較的単純ですが，自動車にはこれらの機構部が複数箇所にあります．

● 未来を感じる機能あれこれ

メカトロニクスからメカ＋エレクトロニクスに切り替えが進む中，ECU 搭載数が最も多いところがボディ系ECUです．
ボディ系ECUの制御対象を図6に示します．

• スマート・キー
• リモートキー・スタータ
• メータ・コンソール
• 運転席などのパワー・シート
• 前後部座席統合制御エアコン
• フロント/リア・ワイパ
• 電動ドア・ミラー
• CMS電子ミラー
• フロント・ライト
• リア集合ライト
• ウィンカ・ライト
• パワー・ウィンドウ
• サイド・ドア・ロック
• オートマチック・スライド・ドア・アシスト
• リア・パワー・ゲート
• オート・トランク開閉
• 室内灯
• 緊急コール/データ・コミュニケーション・モジュール
• 高度トラフィック・コントロール
• タイヤ空気圧警告
• ブレーキ・ロータ温度警告

ボディ系ECUはその特性上，運転手や乗客に対して乗車時の快適性を与えるというものです．
例えば以下の項目がボディ系ECUによる電子制御で実現されています．

・ メータやバック・ガイド・モニタに大型LCDを採用することで車両情報を見える化
・ 前方監視カメラで対向車を認識してヘッドライトのハイ/ ローを自動切り替え
・ 高速巡行と街乗りの速度を認識してワイパの間欠時間を可変にする

一般にボディ系ECUは操作を間違えたり故障したりしても，運転能力が損なわれるわけではありません．
とは言うものの，不具合発生時には著しく運転手と乗客の快適さを奪うことになります．
そのためパワトレ系，シャシ系ECUほどではありませんが，これら機構部の制御をつかさどるECUとして，高い品質を要求されます．
さらに，操作性や視認性について直感的に理解できるような「ユーザビリティ」も同時に求められます．
